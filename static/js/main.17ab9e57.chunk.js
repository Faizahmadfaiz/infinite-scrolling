(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{30:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n.n(c),r=n(21),s=n.n(r),o=(n(30),n(10)),a=n(2),u=n(14),j=n(13),l={signIn:function(e){setTimeout(e,100)},signOut:function(e){setTimeout(e,100)}},b=function(){var e=Object(c.useState)(null),t=Object(j.a)(e,2),n=t[0],i=t[1];return{user:n,signIn:function(e){l.signIn((function(){i("foo"),e()}))},signOut:function(e){l.signOut((function(){i(null),e()}))}}},d=n(1),h=Object(c.createContext)(null),f=function(e){var t=e.children,n=b();return Object(d.jsx)(h.Provider,{value:n,children:t})},O=function(){return Object(c.useContext)(h)},g=function(){var e=Object(a.g)(),t=O();return console.log("User: ",null===t||void 0===t?void 0:t.user),(null===t||void 0===t?void 0:t.user)?Object(d.jsxs)("p",{children:["Welcome!"," ",Object(d.jsx)(u.a,{onClick:function(){null===t||void 0===t||t.signOut((function(){return e.push("/")}))},children:"Sign out"})]}):Object(d.jsx)("p",{children:"You are not logged in."})},p=n(9),x=n(25),m=function(e){var t=e.children,n=Object(x.a)(e,["children"]),c=O();return Object(d.jsx)(a.b,Object(p.a)(Object(p.a)({},n),{},{render:function(e){var n=e.location;return(null===c||void 0===c?void 0:c.user)?t:Object(d.jsx)(a.a,{to:{pathname:"/login",state:{from:n}}})}}))},v=n(23),E=n(24),I=n(11),C=function(){var e,t,n=Object(c.useReducer)((function(e,t){switch(t.type){case"STACK_IMAGES":return Object(p.a)(Object(p.a)({},e),{},{images:e.images.concat(t.images)});case"FETCHING_IMAGES":return Object(p.a)(Object(p.a)({},e),{},{fetching:t.fetching});default:return e}}),{images:[],fetching:!0}),i=Object(j.a)(n,2),r=i[0],s=i[1],o=Object(c.useReducer)((function(e,t){switch(t.type){case"ADVANCE_PAGE":return Object(p.a)(Object(p.a)({},e),{},{page:e.page+1});default:return e}}),{page:0}),a=Object(j.a)(o,2),u=a[0],l=a[1],b=Object(c.useRef)(null);return e=u,t=s,Object(c.useEffect)((function(){t({type:"FETCHING_IMAGES",fetching:!0}),fetch("https://picsum.photos/v2/list?page=".concat(e.page,"&limit=10")).then((function(e){return e.json()})).then((function(e){t({type:"STACK_IMAGES",images:e}),t({type:"FETCHING_IMAGES",fetching:!1})})).catch((function(e){return t({type:"FETCHING_IMAGES",fetching:!1}),e}))}),[t,e.page]),function(e,t){var n=Object(c.useCallback)((function(e){var t=new IntersectionObserver((function(n){n.forEach((function(n){if(n.intersectionRatio>0){var c=n.target,i=c.dataset.src;i?c.src=i:console.error("Image source is invalid"),t.unobserve(e)}}))}));t.observe(e)}),[]),i=Object(c.useRef)(null);Object(c.useEffect)((function(){i.current=document.querySelectorAll(e),i.current&&i.current.forEach((function(e){return n(e)}))}),[n,i,e,t])}(".card-img-top",r.images),function(e,t){var n=Object(c.useCallback)((function(e){new IntersectionObserver((function(e){e.forEach((function(e){e.intersectionRatio>0&&t({type:"ADVANCE_PAGE"})}))})).observe(e)}),[t]);Object(c.useEffect)((function(){e.current&&n(e.current)}),[n,e])}(b,l),Object(d.jsxs)("div",{className:"",children:[Object(d.jsx)(v.a,{id:"images",children:Object(d.jsx)(E.a,{children:r.images.map((function(e,t){var n=e.author,c=e.download_url;return Object(d.jsxs)(I.a,{style:{width:"18rem"},children:[Object(d.jsx)(I.a.Img,{alt:n,"data-src":c,variant:"top",src:"https://picsum.photos/id/870/300/300?grayscale&blur=2",className:"card-img-top"}),Object(d.jsx)(I.a.Body,{children:Object(d.jsx)(I.a.Title,{children:"Card Title"})}),Object(d.jsx)(I.a.Footer,{children:Object(d.jsxs)("small",{className:"text-muted",children:["Shot by: ",n]})})]},t)}))})}),r.fetching&&Object(d.jsx)("div",{className:"text-center bg-secondary m-auto p-3",children:Object(d.jsx)("p",{className:"m-0 text-white",children:"Getting images"})}),Object(d.jsx)("div",{id:"page-bottom-boundary",style:{border:"1px solid red"},ref:b})]})},y=function(){return Object(d.jsx)("div",{children:"This is PublicPage"})},A=function(){var e=Object(a.g)(),t=Object(a.h)(),n=O(),c=(t.state||{from:{pathname:"/"}}).from;return Object(d.jsxs)("div",{children:[Object(d.jsxs)("p",{children:["You must log in to view the page at ",c.pathname]}),Object(d.jsx)(u.a,{onClick:function(){null===n||void 0===n||n.signIn((function(){e.replace(c)}))},children:"Login"})]})},S=(n(37),function(){return Object(d.jsx)(f,{children:Object(d.jsx)(o.a,{children:Object(d.jsxs)("div",{children:[Object(d.jsx)(g,{}),Object(d.jsxs)("ul",{children:[Object(d.jsx)("li",{children:Object(d.jsx)(o.b,{to:"/public-page",children:"Public Page"})}),Object(d.jsx)("li",{children:Object(d.jsx)(o.b,{to:"/home",children:"Home Page"})})]}),Object(d.jsxs)(a.d,{children:[Object(d.jsx)(a.b,{path:"/public-page",children:Object(d.jsx)(y,{})}),Object(d.jsx)(a.b,{path:"/login",children:Object(d.jsx)(A,{})}),Object(d.jsx)(m,{path:"/home",children:Object(d.jsx)(C,{})})]})]})})})}),G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,39)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),i(e),r(e),s(e)}))};s.a.render(Object(d.jsx)(i.a.StrictMode,{children:Object(d.jsx)(S,{})}),document.getElementById("root")),G()}},[[38,1,2]]]);
//# sourceMappingURL=main.17ab9e57.chunk.js.map